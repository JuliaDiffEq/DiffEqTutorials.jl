<!DOCTYPE html>
<HTML lang = "en">
<HEAD>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>DiffEqBiological Tutorial II: Network Properties API</title>
  

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      TeX: { equationNumbers: { autoNumber: "AMS" } }
    });
  </script>

  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

  
<style>
pre.hljl {
    border: 1px solid #ccc;
    margin: 5px;
    padding: 5px;
    overflow-x: auto;
    color: rgb(68,68,68); background-color: rgb(251,251,251); }
pre.hljl > span.hljl-t { }
pre.hljl > span.hljl-w { }
pre.hljl > span.hljl-e { }
pre.hljl > span.hljl-eB { }
pre.hljl > span.hljl-o { }
pre.hljl > span.hljl-k { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kc { color: rgb(59,151,46); font-style: italic; }
pre.hljl > span.hljl-kd { color: rgb(214,102,97); font-style: italic; }
pre.hljl > span.hljl-kn { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kp { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kr { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kt { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-n { }
pre.hljl > span.hljl-na { }
pre.hljl > span.hljl-nb { }
pre.hljl > span.hljl-nbp { }
pre.hljl > span.hljl-nc { }
pre.hljl > span.hljl-ncB { }
pre.hljl > span.hljl-nd { color: rgb(214,102,97); }
pre.hljl > span.hljl-ne { }
pre.hljl > span.hljl-neB { }
pre.hljl > span.hljl-nf { color: rgb(66,102,213); }
pre.hljl > span.hljl-nfm { color: rgb(66,102,213); }
pre.hljl > span.hljl-np { }
pre.hljl > span.hljl-nl { }
pre.hljl > span.hljl-nn { }
pre.hljl > span.hljl-no { }
pre.hljl > span.hljl-nt { }
pre.hljl > span.hljl-nv { }
pre.hljl > span.hljl-nvc { }
pre.hljl > span.hljl-nvg { }
pre.hljl > span.hljl-nvi { }
pre.hljl > span.hljl-nvm { }
pre.hljl > span.hljl-l { }
pre.hljl > span.hljl-ld { color: rgb(148,91,176); font-style: italic; }
pre.hljl > span.hljl-s { color: rgb(201,61,57); }
pre.hljl > span.hljl-sa { color: rgb(201,61,57); }
pre.hljl > span.hljl-sb { color: rgb(201,61,57); }
pre.hljl > span.hljl-sc { color: rgb(201,61,57); }
pre.hljl > span.hljl-sd { color: rgb(201,61,57); }
pre.hljl > span.hljl-sdB { color: rgb(201,61,57); }
pre.hljl > span.hljl-sdC { color: rgb(201,61,57); }
pre.hljl > span.hljl-se { color: rgb(59,151,46); }
pre.hljl > span.hljl-sh { color: rgb(201,61,57); }
pre.hljl > span.hljl-si { }
pre.hljl > span.hljl-so { color: rgb(201,61,57); }
pre.hljl > span.hljl-sr { color: rgb(201,61,57); }
pre.hljl > span.hljl-ss { color: rgb(201,61,57); }
pre.hljl > span.hljl-ssB { color: rgb(201,61,57); }
pre.hljl > span.hljl-nB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nbB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nfB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nh { color: rgb(59,151,46); }
pre.hljl > span.hljl-ni { color: rgb(59,151,46); }
pre.hljl > span.hljl-nil { color: rgb(59,151,46); }
pre.hljl > span.hljl-noB { color: rgb(59,151,46); }
pre.hljl > span.hljl-oB { color: rgb(102,102,102); font-weight: bold; }
pre.hljl > span.hljl-ow { color: rgb(102,102,102); font-weight: bold; }
pre.hljl > span.hljl-p { }
pre.hljl > span.hljl-c { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-ch { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cm { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cp { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cpB { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cs { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-csB { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-g { }
pre.hljl > span.hljl-gd { }
pre.hljl > span.hljl-ge { }
pre.hljl > span.hljl-geB { }
pre.hljl > span.hljl-gh { }
pre.hljl > span.hljl-gi { }
pre.hljl > span.hljl-go { }
pre.hljl > span.hljl-gp { }
pre.hljl > span.hljl-gs { }
pre.hljl > span.hljl-gsB { }
pre.hljl > span.hljl-gt { }
</style>



  <style type="text/css">
  @font-face {
  font-style: normal;
  font-weight: 300;
}
@font-face {
  font-style: normal;
  font-weight: 400;
}
@font-face {
  font-style: normal;
  font-weight: 600;
}
html {
  font-family: sans-serif; /* 1 */
  -ms-text-size-adjust: 100%; /* 2 */
  -webkit-text-size-adjust: 100%; /* 2 */
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block; /* 1 */
  vertical-align: baseline; /* 2 */
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
  display: block;
  margin-left: auto;
  margin-right: auto;
  width: 70%;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit; /* 1 */
  font: inherit; /* 2 */
  margin: 0; /* 3 */
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button; /* 2 */
  cursor: pointer; /* 3 */
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box; /* 1 */
  padding: 0; /* 2 */
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield; /* 1 */
  -moz-box-sizing: content-box;
  -webkit-box-sizing: content-box; /* 2 */
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0; /* 1 */
  padding: 0; /* 2 */
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  font-family: monospace, monospace;
  font-size : 0.8em;
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
thead th {
    border-bottom: 1px solid black;
    background-color: white;
}
tr:nth-child(odd){
  background-color: rgb(248,248,248);
}


/*
* Skeleton V2.0.4
* Copyright 2014, Dave Gamache
* www.getskeleton.com
* Free to use under the MIT license.
* http://www.opensource.org/licenses/mit-license.php
* 12/29/2014
*/
.container {
  position: relative;
  width: 100%;
  max-width: 960px;
  margin: 0 auto;
  padding: 0 20px;
  box-sizing: border-box; }
.column,
.columns {
  width: 100%;
  float: left;
  box-sizing: border-box; }
@media (min-width: 400px) {
  .container {
    width: 85%;
    padding: 0; }
}
@media (min-width: 550px) {
  .container {
    width: 80%; }
  .column,
  .columns {
    margin-left: 4%; }
  .column:first-child,
  .columns:first-child {
    margin-left: 0; }

  .one.column,
  .one.columns                    { width: 4.66666666667%; }
  .two.columns                    { width: 13.3333333333%; }
  .three.columns                  { width: 22%;            }
  .four.columns                   { width: 30.6666666667%; }
  .five.columns                   { width: 39.3333333333%; }
  .six.columns                    { width: 48%;            }
  .seven.columns                  { width: 56.6666666667%; }
  .eight.columns                  { width: 65.3333333333%; }
  .nine.columns                   { width: 74.0%;          }
  .ten.columns                    { width: 82.6666666667%; }
  .eleven.columns                 { width: 91.3333333333%; }
  .twelve.columns                 { width: 100%; margin-left: 0; }

  .one-third.column               { width: 30.6666666667%; }
  .two-thirds.column              { width: 65.3333333333%; }

  .one-half.column                { width: 48%; }

  /* Offsets */
  .offset-by-one.column,
  .offset-by-one.columns          { margin-left: 8.66666666667%; }
  .offset-by-two.column,
  .offset-by-two.columns          { margin-left: 17.3333333333%; }
  .offset-by-three.column,
  .offset-by-three.columns        { margin-left: 26%;            }
  .offset-by-four.column,
  .offset-by-four.columns         { margin-left: 34.6666666667%; }
  .offset-by-five.column,
  .offset-by-five.columns         { margin-left: 43.3333333333%; }
  .offset-by-six.column,
  .offset-by-six.columns          { margin-left: 52%;            }
  .offset-by-seven.column,
  .offset-by-seven.columns        { margin-left: 60.6666666667%; }
  .offset-by-eight.column,
  .offset-by-eight.columns        { margin-left: 69.3333333333%; }
  .offset-by-nine.column,
  .offset-by-nine.columns         { margin-left: 78.0%;          }
  .offset-by-ten.column,
  .offset-by-ten.columns          { margin-left: 86.6666666667%; }
  .offset-by-eleven.column,
  .offset-by-eleven.columns       { margin-left: 95.3333333333%; }

  .offset-by-one-third.column,
  .offset-by-one-third.columns    { margin-left: 34.6666666667%; }
  .offset-by-two-thirds.column,
  .offset-by-two-thirds.columns   { margin-left: 69.3333333333%; }

  .offset-by-one-half.column,
  .offset-by-one-half.columns     { margin-left: 52%; }

}
html {
  font-size: 62.5%; }
body {
  font-size: 1.5em; /* currently ems cause chrome bug misinterpreting rems on body element */
  line-height: 1.6;
  font-weight: 400;
  font-family: "Raleway", "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif;
  color: #222; }
h1, h2, h3, h4, h5, h6 {
  margin-top: 0;
  margin-bottom: 2rem;
  font-weight: 300; }
h1 { font-size: 3.6rem; line-height: 1.2;  letter-spacing: -.1rem;}
h2 { font-size: 3.4rem; line-height: 1.25; letter-spacing: -.1rem; }
h3 { font-size: 3.2rem; line-height: 1.3;  letter-spacing: -.1rem; }
h4 { font-size: 2.8rem; line-height: 1.35; letter-spacing: -.08rem; }
h5 { font-size: 2.4rem; line-height: 1.5;  letter-spacing: -.05rem; }
h6 { font-size: 1.5rem; line-height: 1.6;  letter-spacing: 0; }

p {
  margin-top: 0; }
a {
  color: #1EAEDB; }
a:hover {
  color: #0FA0CE; }
.button,
button,
input[type="submit"],
input[type="reset"],
input[type="button"] {
  display: inline-block;
  height: 38px;
  padding: 0 30px;
  color: #555;
  text-align: center;
  font-size: 11px;
  font-weight: 600;
  line-height: 38px;
  letter-spacing: .1rem;
  text-transform: uppercase;
  text-decoration: none;
  white-space: nowrap;
  background-color: transparent;
  border-radius: 4px;
  border: 1px solid #bbb;
  cursor: pointer;
  box-sizing: border-box; }
.button:hover,
button:hover,
input[type="submit"]:hover,
input[type="reset"]:hover,
input[type="button"]:hover,
.button:focus,
button:focus,
input[type="submit"]:focus,
input[type="reset"]:focus,
input[type="button"]:focus {
  color: #333;
  border-color: #888;
  outline: 0; }
.button.button-primary,
button.button-primary,
input[type="submit"].button-primary,
input[type="reset"].button-primary,
input[type="button"].button-primary {
  color: #FFF;
  background-color: #33C3F0;
  border-color: #33C3F0; }
.button.button-primary:hover,
button.button-primary:hover,
input[type="submit"].button-primary:hover,
input[type="reset"].button-primary:hover,
input[type="button"].button-primary:hover,
.button.button-primary:focus,
button.button-primary:focus,
input[type="submit"].button-primary:focus,
input[type="reset"].button-primary:focus,
input[type="button"].button-primary:focus {
  color: #FFF;
  background-color: #1EAEDB;
  border-color: #1EAEDB; }
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea,
select {
  height: 38px;
  padding: 6px 10px; /* The 6px vertically centers text on FF, ignored by Webkit */
  background-color: #fff;
  border: 1px solid #D1D1D1;
  border-radius: 4px;
  box-shadow: none;
  box-sizing: border-box; }
/* Removes awkward default styles on some inputs for iOS */
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea {
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none; }
textarea {
  min-height: 65px;
  padding-top: 6px;
  padding-bottom: 6px; }
input[type="email"]:focus,
input[type="number"]:focus,
input[type="search"]:focus,
input[type="text"]:focus,
input[type="tel"]:focus,
input[type="url"]:focus,
input[type="password"]:focus,
textarea:focus,
select:focus {
  border: 1px solid #33C3F0;
  outline: 0; }
label,
legend {
  display: block;
  margin-bottom: .5rem;
  font-weight: 600; }
fieldset {
  padding: 0;
  border-width: 0; }
input[type="checkbox"],
input[type="radio"] {
  display: inline; }
label > .label-body {
  display: inline-block;
  margin-left: .5rem;
  font-weight: normal; }
ul {
  list-style: circle; }
ol {
  list-style: decimal; }
ul ul,
ul ol,
ol ol,
ol ul {
  margin: 1.5rem 0 1.5rem 3rem;
  font-size: 90%; }
li > p {margin : 0;}
th,
td {
  padding: 12px 15px;
  text-align: left;
  border-bottom: 1px solid #E1E1E1; }
th:first-child,
td:first-child {
  padding-left: 0; }
th:last-child,
td:last-child {
  padding-right: 0; }
button,
.button {
  margin-bottom: 1rem; }
input,
textarea,
select,
fieldset {
  margin-bottom: 1.5rem; }
pre,
blockquote,
dl,
figure,
table,
p,
ul,
ol,
form {
  margin-bottom: 1.0rem; }
.u-full-width {
  width: 100%;
  box-sizing: border-box; }
.u-max-full-width {
  max-width: 100%;
  box-sizing: border-box; }
.u-pull-right {
  float: right; }
.u-pull-left {
  float: left; }
hr {
  margin-top: 3rem;
  margin-bottom: 3.5rem;
  border-width: 0;
  border-top: 1px solid #E1E1E1; }
.container:after,
.row:after,
.u-cf {
  content: "";
  display: table;
  clear: both; }

pre {
  display: block;
  padding: 9.5px;
  margin: 0 0 10px;
  font-size: 13px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre.hljl {
  margin: 0 0 10px;
  display: block;
  background: #f5f5f5;
  border-radius: 4px;
  padding : 5px;
}

pre.output {
  background: #ffffff;
}

pre.code {
  background: #ffffff;
}

pre.julia-error {
  color : red
}

code,
kbd,
pre,
samp {
  font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
  font-size: 13px;
}


@media (min-width: 400px) {}
@media (min-width: 550px) {}
@media (min-width: 750px) {}
@media (min-width: 1000px) {}
@media (min-width: 1200px) {}

h1.title {margin-top : 20px}
img {max-width : 100%}
div.title {text-align: center;}

  </style>
</HEAD>

<BODY>
  <div class ="container">
    <div class = "row">
      <div class = "col-md-12 twelve columns">
        <div class="title">
          <h1 class="title">DiffEqBiological Tutorial II: Network Properties API</h1>
          <h5>Samuel Isaacson</h5>
          
        </div>

        <p>The <a href="https://docs.sciml.ai/dev/apis/diffeqbio">DiffEqBiological API</a> provides a collection of functions for easily accessing network properties, and for incrementally building and extending a network. In this tutorial we&#39;ll go through the API, and then illustrate how to programmatically construct a network.</p>
<p>We&#39;ll illustrate the API using a toggle-switch like network that contains a variety of different reaction types:</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>DifferentialEquations</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>DiffEqBiological</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Latexify</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Plots</span><span class='hljl-t'>
</span><span class='hljl-n'>fmt</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:svg</span><span class='hljl-t'>
</span><span class='hljl-nf'>pyplot</span><span class='hljl-p'>(</span><span class='hljl-n'>fmt</span><span class='hljl-oB'>=</span><span class='hljl-n'>fmt</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>rn</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@reaction_network</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-nf'>hillr</span><span class='hljl-p'>(</span><span class='hljl-n'>D₂</span><span class='hljl-p'>,</span><span class='hljl-n'>α</span><span class='hljl-p'>,</span><span class='hljl-n'>K</span><span class='hljl-p'>,</span><span class='hljl-n'>n</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>∅</span><span class='hljl-t'> </span><span class='hljl-oB'>--&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>m₁</span><span class='hljl-t'>
    </span><span class='hljl-nf'>hillr</span><span class='hljl-p'>(</span><span class='hljl-n'>D₁</span><span class='hljl-p'>,</span><span class='hljl-n'>α</span><span class='hljl-p'>,</span><span class='hljl-n'>K</span><span class='hljl-p'>,</span><span class='hljl-n'>n</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>∅</span><span class='hljl-t'> </span><span class='hljl-oB'>--&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>m₂</span><span class='hljl-t'>
    </span><span class='hljl-p'>(</span><span class='hljl-n'>δ</span><span class='hljl-p'>,</span><span class='hljl-n'>γ</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>m₁</span><span class='hljl-t'> </span><span class='hljl-oB'>↔</span><span class='hljl-t'> </span><span class='hljl-n'>∅</span><span class='hljl-t'>
    </span><span class='hljl-p'>(</span><span class='hljl-n'>δ</span><span class='hljl-p'>,</span><span class='hljl-n'>γ</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>m₂</span><span class='hljl-t'> </span><span class='hljl-oB'>↔</span><span class='hljl-t'> </span><span class='hljl-n'>∅</span><span class='hljl-t'>
    </span><span class='hljl-n'>β</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m₁</span><span class='hljl-t'> </span><span class='hljl-oB'>--&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>m₁</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>P₁</span><span class='hljl-t'>
    </span><span class='hljl-n'>β</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m₂</span><span class='hljl-t'> </span><span class='hljl-oB'>--&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>m₂</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>P₂</span><span class='hljl-t'>
    </span><span class='hljl-n'>μ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>P₁</span><span class='hljl-t'> </span><span class='hljl-oB'>--&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>∅</span><span class='hljl-t'>
    </span><span class='hljl-n'>μ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>P₂</span><span class='hljl-t'> </span><span class='hljl-oB'>--&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>∅</span><span class='hljl-t'>
    </span><span class='hljl-p'>(</span><span class='hljl-n'>k₊</span><span class='hljl-p'>,</span><span class='hljl-n'>k₋</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>P₁</span><span class='hljl-t'> </span><span class='hljl-oB'>↔</span><span class='hljl-t'> </span><span class='hljl-n'>D₁</span><span class='hljl-t'>
    </span><span class='hljl-p'>(</span><span class='hljl-n'>k₊</span><span class='hljl-p'>,</span><span class='hljl-n'>k₋</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>P₂</span><span class='hljl-t'> </span><span class='hljl-oB'>↔</span><span class='hljl-t'> </span><span class='hljl-n'>D₂</span><span class='hljl-t'>
    </span><span class='hljl-p'>(</span><span class='hljl-n'>k₊</span><span class='hljl-p'>,</span><span class='hljl-n'>k₋</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>P₁</span><span class='hljl-oB'>+</span><span class='hljl-n'>P₂</span><span class='hljl-t'> </span><span class='hljl-oB'>↔</span><span class='hljl-t'> </span><span class='hljl-n'>T</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'> </span><span class='hljl-n'>α</span><span class='hljl-t'> </span><span class='hljl-n'>K</span><span class='hljl-t'> </span><span class='hljl-n'>n</span><span class='hljl-t'> </span><span class='hljl-n'>δ</span><span class='hljl-t'> </span><span class='hljl-n'>γ</span><span class='hljl-t'> </span><span class='hljl-n'>β</span><span class='hljl-t'> </span><span class='hljl-n'>μ</span><span class='hljl-t'> </span><span class='hljl-n'>k₊</span><span class='hljl-t'> </span><span class='hljl-n'>k₋</span><span class='hljl-p'>;</span>
</pre>


<pre class="julia-error">
ERROR: ArgumentError: Package DiffEqBiological not found in current path:
- Run &#96;import Pkg; Pkg.add&#40;&quot;DiffEqBiological&quot;&#41;&#96; to install the DiffEqBiological package.

</pre>


<p>This corresponds to the chemical reaction network given by</p>


<pre class='hljl'>
<span class='hljl-nf'>latexify</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>env</span><span class='hljl-oB'>=:</span><span class='hljl-n'>chemical</span><span class='hljl-p'>)</span>
</pre>



<pre class="julia-error">
ERROR: UndefVarError: latexify not defined
</pre>


<hr />
<h2>Network Properties</h2>
<p><a href="https://docs.sciml.ai/latest/apis/diffeqbio/#Basic-properties-1">Basic properties</a> of the generated network include the <code>speciesmap</code> and <code>paramsmap</code> functions we examined in the last tutorial, along with the corresponding <code>species</code> and <code>params</code> functions:</p>


<pre class='hljl'>
<span class='hljl-nf'>species</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: species not defined
</pre>



<pre class='hljl'>
<span class='hljl-nf'>params</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: params not defined
</pre>


<p>The numbers of species, parameters and reactions can be accessed using <code>numspecies&#40;rn&#41;</code>, <code>numparams&#40;rn&#41;</code> and <code>numreactions&#40;rn&#41;</code>.</p>
<p>A number of functions are available to access <a href="https://docs.sciml.ai/latest/apis/diffeqbio/#Reaction-Properties-1">properties of reactions</a> within the generated network, including <code>substrates</code>, <code>products</code>, <code>dependents</code>, <code>ismassaction</code>, <code>substratestoich</code>, <code>substratesymstoich</code>, <code>productstoich</code>, <code>productsymstoich</code>, and <code>netstoich</code>. Each of these functions takes two arguments, the reaction network <code>rn</code> and the index of the reaction to query information about. For example, to find the substrate symbols and their corresponding stoichiometries for the 11th reaction, <code>2P₁ --&gt; D₁</code>, we would use</p>


<pre class='hljl'>
<span class='hljl-nf'>substratesymstoich</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>11</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: substratesymstoich not defined
</pre>


<p>Broadcasting works on all these functions, allowing the construction of a vector holding the queried information across all reactions, i.e.</p>


<pre class='hljl'>
<span class='hljl-n'>substratesymstoich</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-nf'>numreactions</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>))</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: numreactions not defined
</pre>


<p>To see the net stoichiometries for all reactions we would use</p>


<pre class='hljl'>
<span class='hljl-n'>netstoich</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-nf'>numreactions</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>))</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: numreactions not defined
</pre>


<p>Here the first integer in each pair corresponds to the index of the species &#40;with symbol <code>species&#40;rn&#41;&#91;index&#93;</code>&#41;. The second integer corresponds to the net stoichiometric coefficient of the species within the reaction. <code>substratestoich</code> and <code>productstoich</code> are defined similarly.</p>
<p>Several functions are also provided that calculate different types of <a href="https://docs.sciml.ai/latest/apis/diffeqbio/#Dependency-Graphs-1">dependency graphs</a>. These include <code>rxtospecies_depgraph</code>, which provides a mapping from reaction index to the indices of species whose population changes when the reaction occurs:</p>


<pre class='hljl'>
<span class='hljl-nf'>rxtospecies_depgraph</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: rxtospecies_depgraph not defined
</pre>


<p>Here the last row indicates that the species with indices <code>&#91;3,4,7&#93;</code> will change values when the reaction <code>T --&gt; P₁ &#43; P₂</code> occurs. To confirm these are the correct species we can look at</p>


<pre class='hljl'>
<span class='hljl-nf'>species</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>)[[</span><span class='hljl-ni'>3</span><span class='hljl-p'>,</span><span class='hljl-ni'>4</span><span class='hljl-p'>,</span><span class='hljl-ni'>7</span><span class='hljl-p'>]]</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: species not defined
</pre>


<p>The <code>speciestorx_depgraph</code> similarly provides a mapping from species to reactions for which their <em>rate laws</em> depend on that species. These correspond to all reactions for which the given species is in the <code>dependent</code> set of the reaction. We can verify this for the first species, <code>m₁</code>:</p>


<pre class='hljl'>
<span class='hljl-nf'>speciestorx_depgraph</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>)[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: speciestorx_depgraph not defined
</pre>



<pre class='hljl'>
<span class='hljl-nf'>findall</span><span class='hljl-p'>(</span><span class='hljl-n'>depset</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-p'>(</span><span class='hljl-sc'>:m₁</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>depset</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>dependents</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-nf'>numreactions</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>)))</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: numreactions not defined
</pre>


<p>Finally, <code>rxtorx_depgraph</code> provides a mapping that shows when a given reaction occurs, which other reactions have rate laws that involve species whose value would have changed:</p>


<pre class='hljl'>
<span class='hljl-nf'>rxtorx_depgraph</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: rxtorx_depgraph not defined
</pre>


<h4>Note on Using Network Property API Functions</h4>
<p>Many basic network query and reaction property functions are simply accessors, returning information that is already stored within the generated <code>reaction_network</code>. For these functions, modifying the returned data structures may lead to inconsistent internal state within the network. As such, they should be used for accessing, but not modifying, network properties. The <a href="https://docs.sciml.ai/dev/apis/diffeqbio">API documentation</a> indicates which functions return newly allocated data structures and which return data stored within the <code>reaction_network</code>.</p>
<hr />
<h2>Incremental Construction of Networks</h2>
<p>The <code>@reaction_network</code> macro is monolithic, in that it not only constructs and stores basic network properties such as the reaction stoichiometries, but also generates <strong>everything</strong> needed to immediately solve ODE, SDE and jump models using the network. This includes Jacobian functions, noise functions, and jump functions for each reaction. While this allows for a compact interface to the DifferentialEquations.jl solvers, it can also be computationally expensive for large networks, where a user may only wish to solve one type of problem and/or have fine-grained control over what is generated. In addition, some types of reaction network structures are more amenable to being constructed programmatically, as opposed to writing out all reactions by hand within one macro. For these reasons DiffEqBiological provides two additional macros that only <em>initially</em> setup basic reaction network properties, and which can be extended through a programmatic interface: <code>@min_reaction_network</code> and <code>@empty_reaction_network</code>. We now give an introduction to constructing these more minimal network representations, and how they can be programmatically extended. See also the relevant <a href="https://docs.sciml.ai/latest/apis/diffeqbio/#Reaction-Network-Generation-Macros-1">API section</a>.</p>
<p>The <code>@min_reaction_network</code> macro works identically to the <code>@reaction_network</code> macro, but the generated network will only be complete with respect to its representation of chemical network properties &#40;i.e. species, parameters and reactions&#41;. No ODE, SDE or jump models are generated during the macro call. It can subsequently be extended with the addition of new species, parameters or reactions. The <code>@empty_reaction_network</code> allocates an empty network structure that can also be extended using the programmatic interface. For example, consider a partial version of the toggle-switch like network we defined above:</p>


<pre class='hljl'>
<span class='hljl-n'>rnmin</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@min_reaction_network</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-p'>(</span><span class='hljl-n'>δ</span><span class='hljl-p'>,</span><span class='hljl-n'>γ</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>m₁</span><span class='hljl-t'> </span><span class='hljl-oB'>↔</span><span class='hljl-t'> </span><span class='hljl-n'>∅</span><span class='hljl-t'>
    </span><span class='hljl-p'>(</span><span class='hljl-n'>δ</span><span class='hljl-p'>,</span><span class='hljl-n'>γ</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>m₂</span><span class='hljl-t'> </span><span class='hljl-oB'>↔</span><span class='hljl-t'> </span><span class='hljl-n'>∅</span><span class='hljl-t'>
    </span><span class='hljl-n'>β</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m₁</span><span class='hljl-t'> </span><span class='hljl-oB'>--&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>m₁</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>P₁</span><span class='hljl-t'>
    </span><span class='hljl-n'>β</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>m₂</span><span class='hljl-t'> </span><span class='hljl-oB'>--&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>m₂</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>P₂</span><span class='hljl-t'>
    </span><span class='hljl-n'>μ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>P₁</span><span class='hljl-t'> </span><span class='hljl-oB'>--&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>∅</span><span class='hljl-t'>
    </span><span class='hljl-n'>μ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>P₂</span><span class='hljl-t'> </span><span class='hljl-oB'>--&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>∅</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'> </span><span class='hljl-n'>δ</span><span class='hljl-t'> </span><span class='hljl-n'>γ</span><span class='hljl-t'> </span><span class='hljl-n'>β</span><span class='hljl-t'> </span><span class='hljl-n'>μ</span><span class='hljl-p'>;</span>
</pre>


<pre class="julia-error">
ERROR: LoadError: UndefVarError: @min_reaction_network not defined
in expression starting at /builds/JuliaGPU/DiffEqTutorials.jl/tutorials/models/04-diffeqbio_II_networkproperties.jmd:2
</pre>


<p>Here we have left out the first two, and last three, reactions from the original <code>reaction_network</code>. To expand the network until it is functionally equivalent to the original model we add back in the missing species, parameters, and <em>finally</em> the missing reactions. Note, it is required that species and parameters be defined before any reactions using them are added. The necessary network extension functions are given by <code>addspecies&#33;</code>, <code>addparam&#33;</code> and <code>addreaction&#33;</code>, and described in the <a href="https://docs.sciml.ai/latest/apis/diffeqbio/#Functions-to-Add-Species,-Parameters-and-Reactions-to-a-Network-1">API</a>. To complete <code>rnmin</code> we first add the relevant species:</p>


<pre class='hljl'>
<span class='hljl-nf'>addspecies!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:D₁</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>addspecies!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:D₂</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>addspecies!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:T</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: addspecies&#33; not defined
</pre>


<p>Next we add the needed parameters</p>


<pre class='hljl'>
<span class='hljl-nf'>addparam!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:α</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>addparam!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:K</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>addparam!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:n</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>addparam!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:k₊</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>addparam!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:k₋</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: addparam&#33; not defined
</pre>


<p>Note, both <code>addspecies&#33;</code> and <code>addparam&#33;</code> also accept strings encoding the variable names &#40;which are then converted to <code>Symbol</code>s internally&#41;.</p>
<p>We are now ready to add the missing reactions. The API provides two forms of the <code>addreaction&#33;</code> function, one takes expressions analogous to what one would write in the macro:</p>


<pre class='hljl'>
<span class='hljl-nf'>addreaction!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-p'>(</span><span class='hljl-nf'>hillr</span><span class='hljl-p'>(</span><span class='hljl-n'>D₁</span><span class='hljl-p'>,</span><span class='hljl-n'>α</span><span class='hljl-p'>,</span><span class='hljl-n'>K</span><span class='hljl-p'>,</span><span class='hljl-n'>n</span><span class='hljl-p'>)),</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-p'>(</span><span class='hljl-n'>∅</span><span class='hljl-t'> </span><span class='hljl-oB'>--&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>m₂</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>addreaction!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-p'>((</span><span class='hljl-n'>k₊</span><span class='hljl-p'>,</span><span class='hljl-n'>k₋</span><span class='hljl-p'>)),</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-n'>P₂</span><span class='hljl-t'> </span><span class='hljl-oB'>↔</span><span class='hljl-t'> </span><span class='hljl-n'>D₂</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>addreaction!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:k₊</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-p'>(</span><span class='hljl-ni'>2</span><span class='hljl-n'>P₁</span><span class='hljl-t'> </span><span class='hljl-oB'>--&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>D₁</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-nf'>addreaction!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:k₋</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-p'>(</span><span class='hljl-n'>D₁</span><span class='hljl-t'> </span><span class='hljl-oB'>--&gt;</span><span class='hljl-t'> </span><span class='hljl-ni'>2</span><span class='hljl-n'>P₁</span><span class='hljl-p'>))</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: addreaction&#33; not defined
</pre>


<p>The rate can be an expression or symbol as above, but can also just be a numeric value. The second form of <code>addreaction&#33;</code> takes tuples of <code>Pair&#123;Symbol,Int&#125;</code> that encode the stoichiometric coefficients of substrates and reactants:</p>


<pre class='hljl'>
<span class='hljl-cs'># signature is addreaction!(rnmin, paramexpr, substratestoich, productstoich)</span><span class='hljl-t'>
</span><span class='hljl-nf'>addreaction!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-p'>(</span><span class='hljl-nf'>hillr</span><span class='hljl-p'>(</span><span class='hljl-n'>D₂</span><span class='hljl-p'>,</span><span class='hljl-n'>α</span><span class='hljl-p'>,</span><span class='hljl-n'>K</span><span class='hljl-p'>,</span><span class='hljl-n'>n</span><span class='hljl-p'>)),</span><span class='hljl-t'> </span><span class='hljl-p'>(),</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-sc'>:m₁</span><span class='hljl-t'> </span><span class='hljl-oB'>=&gt;</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,))</span><span class='hljl-t'>
</span><span class='hljl-nf'>addreaction!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:k₊</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-sc'>:P₁</span><span class='hljl-oB'>=&gt;</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:P₂</span><span class='hljl-oB'>=&gt;</span><span class='hljl-ni'>1</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-sc'>:T</span><span class='hljl-oB'>=&gt;</span><span class='hljl-ni'>1</span><span class='hljl-p'>,))</span><span class='hljl-t'>
</span><span class='hljl-nf'>addreaction!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:k₋</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-sc'>:T</span><span class='hljl-oB'>=&gt;</span><span class='hljl-ni'>1</span><span class='hljl-p'>,),</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-sc'>:P₁</span><span class='hljl-oB'>=&gt;</span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:P₂</span><span class='hljl-oB'>=&gt;</span><span class='hljl-ni'>1</span><span class='hljl-p'>))</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: addreaction&#33; not defined
</pre>


<p>Let&#39;s check that <code>rn</code> and <code>rnmin</code> have the same set of species:</p>


<pre class='hljl'>
<span class='hljl-nf'>setdiff</span><span class='hljl-p'>(</span><span class='hljl-nf'>species</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>species</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>))</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: species not defined
</pre>


<p>the same set of params:</p>


<pre class='hljl'>
<span class='hljl-nf'>setdiff</span><span class='hljl-p'>(</span><span class='hljl-nf'>params</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>params</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>))</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: params not defined
</pre>


<p>and the final reaction has the same substrates, reactions, and rate expression:</p>


<pre class='hljl'>
<span class='hljl-n'>rxidx</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>numreactions</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>setdiff</span><span class='hljl-p'>(</span><span class='hljl-nf'>substrates</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>rxidx</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>substrates</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>rxidx</span><span class='hljl-p'>))</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: numreactions not defined
</pre>



<pre class='hljl'>
<span class='hljl-nf'>setdiff</span><span class='hljl-p'>(</span><span class='hljl-nf'>products</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>rxidx</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-nf'>products</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>rxidx</span><span class='hljl-p'>))</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: products not defined
</pre>



<pre class='hljl'>
<span class='hljl-nf'>rateexpr</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>rxidx</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>==</span><span class='hljl-t'> </span><span class='hljl-nf'>rateexpr</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>rxidx</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: rateexpr not defined
</pre>


<hr />
<h2>Extending Incrementally Generated Networks to Include ODEs, SDEs or Jumps</h2>
<p>Once a network generated from <code>@min_reaction_network</code> or <code>@empty_reaction_network</code> has had all the associated species, parameters and reactions filled in, corresponding ODE, SDE or jump models can be constructed. The relevant API functions are <code>addodes&#33;</code>, <code>addsdes&#33;</code> and <code>addjumps&#33;</code>. One benefit to contructing models with these functions is that they offer more fine-grained control over what actually gets constructed. For example, <code>addodes&#33;</code> has the optional keyword argument, <code>build_jac</code>, which if set to <code>false</code> will disable construction of symbolic Jacobians and functions for evaluating Jacobians. For large networks this can give a significant speed-up in the time required for constructing an ODE model. Each function and its associated keyword arguments are described in the API section, <a href="https://docs.sciml.ai/latest/apis/diffeqbio/#Functions-to-Add-ODEs,-SDEs-or-Jumps-to-a-Network-1">Functions to add ODEs, SDEs or Jumps to a Network</a>.</p>
<p>Let&#39;s extend <code>rnmin</code> to include the needed functions for use in ODE solvers:</p>


<pre class='hljl'>
<span class='hljl-nf'>addodes!</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: addodes&#33; not defined
</pre>


<p>The <a href="https://docs.sciml.ai/latest/apis/diffeqbio/#Generated-Functions-for-Models-1">Generated Functions for Models</a> section of the API shows what functions have been generated. For ODEs these include <code>oderhsfun&#40;rnmin&#41;</code>, which returns a function of the form <code>f&#40;du,u,p,t&#41;</code> which evaluates the ODEs &#40;i.e. the time derivatives of <code>u</code>&#41; within <code>du</code>. For each generated function, the corresponding expressions from which it was generated can be retrieved using accessors from the <a href="https://docs.sciml.ai/latest/apis/diffeqbio/#Generated-Expressions-1">Generated Expressions</a> section of the API. The equations within <code>du</code> can be retrieved using the <code>odeexprs&#40;rnmin&#41;</code> function. For example:</p>


<pre class='hljl'>
<span class='hljl-nf'>odeexprs</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: odeexprs not defined
</pre>


<p>Using Latexify we can see the ODEs themselves to compare with these expressions:</p>


<pre class='hljl'>
<span class='hljl-nf'>latexify</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>)</span>
</pre>



<pre class="julia-error">
ERROR: UndefVarError: latexify not defined
</pre>


<p>For ODEs two other functions are generated by <code>addodes&#33;</code>. <code>jacfun&#40;rnmin&#41;</code> will return the generated Jacobian evaluation function, <code>fjac&#40;dJ,u,p,t&#41;</code>, which given the current solution <code>u</code> evaluates the Jacobian within <code>dJ</code>. <code>jacobianexprs&#40;rnmin&#41;</code> gives the corresponding matrix of expressions, which can be used with Latexify to see the Jacobian:</p>


<pre class='hljl'>
<span class='hljl-nf'>latexify</span><span class='hljl-p'>(</span><span class='hljl-nf'>jacobianexprs</span><span class='hljl-p'>(</span><span class='hljl-n'>rnmin</span><span class='hljl-p'>))</span>
</pre>



<pre class="julia-error">
ERROR: UndefVarError: jacobianexprs not defined
</pre>


<p><code>addodes&#33;</code> also generates a function that evaluates the Jacobian of the ODE derivative functions with respect to the parameters. <code>paramjacfun&#40;rnmin&#41;</code> then returns the generated function. It has the form <code>fpjac&#40;dPJ,u,p,t&#41;</code>, which given the current solution <code>u</code> evaluates the Jacobian matrix with respect to parameters <code>p</code> within <code>dPJ</code>. For use in DifferentialEquations.jl solvers, an <a href="https://docs.sciml.ai/dev/features/performance_overloads"><code>ODEFunction</code></a> representation of the ODEs is available from <code>odefun&#40;rnmin&#41;</code>.</p>
<p><code>addsdes&#33;</code> and <code>addjumps&#33;</code> work similarly to complete the network for use in StochasticDiffEq and DiffEqJump solvers.</p>
<h4>Note on Using Generated Function and Expression API Functions</h4>
<p>The generated functions and expressions accessible through the API require first calling the appropriate <code>addodes&#33;</code>, <code>addsdes</code> or <code>addjumps</code> function. These are responsible for actually constructing the underlying functions and expressions. The API accessors simply return already constructed functions and expressions that are stored within the <code>reaction_network</code> structure.</p>
<hr />
<h2>Example of Generating a Network Programmatically</h2>
<p>For a user directly typing in a reaction network, it is generally easier to use the <code>@min_reaction_network</code> or <code>@reaction_network</code> macros to fully specify reactions. However, for large, structured networks it can be much easier to generate the network programmatically. For very large networks, with tens of thousands of reactions, the form of <code>addreaction&#33;</code> that uses stoichiometric coefficients should be preferred as it offers substantially better performance. To put together everything we&#39;ve seen, let&#39;s generate the network corresponding to a 1D continuous time random walk, approximating the diffusion of molecules within an interval.</p>
<p>The basic &quot;reaction&quot; network we wish to study is</p>
<p class="math">\[
u_1 \leftrightarrows u_2 \leftrightarrows u_3 \cdots \leftrightarrows u_{N}
\]</p>
<p>for <span class="math">$N$</span> lattice sites on <span class="math">$[0,1]$</span>. For <span class="math">$h = 1/N$</span> the lattice spacing, we&#39;ll assume the rate molecules hop from their current site to any particular neighbor is just <span class="math">$h^{-2}$</span>. We can interpret this hopping process as a collection of <span class="math">$2N-2$</span> &quot;reactions&quot;, with the form <span class="math">$u_i \to u_j$</span> for <span class="math">$j=i+1$</span> or <span class="math">$j=i-1$</span>. We construct the corresponding reaction network as follows. First we set values for the basic parameters:</p>


<pre class='hljl'>
<span class='hljl-n'>N</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>64</span><span class='hljl-t'>
</span><span class='hljl-n'>h</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-n'>N</span>
</pre>


<pre class="output">
0.015625
</pre>


<p>then we create an empty network, and add each species</p>


<pre class='hljl'>
<span class='hljl-n'>rn</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@empty_reaction_network</span><span class='hljl-t'>

</span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-n'>N</span><span class='hljl-t'>
    </span><span class='hljl-nf'>addspecies!</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>Symbol</span><span class='hljl-p'>(</span><span class='hljl-sc'>:u</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="julia-error">
ERROR: LoadError: UndefVarError: @empty_reaction_network not defined
in expression starting at /builds/JuliaGPU/DiffEqTutorials.jl/tutorials/models/04-diffeqbio_II_networkproperties.jmd:2
</pre>


<p>We next add one parameter <code>β</code>, which we will set equal to the hopping rate of molecules, <span class="math">$h^{-2}$</span>:</p>


<pre class='hljl'>
<span class='hljl-nf'>addparam!</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:β</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: addparam&#33; not defined
</pre>


<p>Finally, we add in the <span class="math">$2N-2$</span> possible hopping reactions:</p>


<pre class='hljl'>
<span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-n'>N</span><span class='hljl-t'>
    </span><span class='hljl-p'>(</span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-oB'>&lt;</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>&amp;&amp;</span><span class='hljl-t'> </span><span class='hljl-nf'>addreaction!</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:β</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>Symbol</span><span class='hljl-p'>(</span><span class='hljl-sc'>:u</span><span class='hljl-p'>,</span><span class='hljl-n'>i</span><span class='hljl-p'>)</span><span class='hljl-oB'>=&gt;</span><span class='hljl-ni'>1</span><span class='hljl-p'>,),</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>Symbol</span><span class='hljl-p'>(</span><span class='hljl-sc'>:u</span><span class='hljl-p'>,</span><span class='hljl-n'>i</span><span class='hljl-oB'>+</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>=&gt;</span><span class='hljl-ni'>1</span><span class='hljl-p'>,))</span><span class='hljl-t'>
    </span><span class='hljl-p'>(</span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-oB'>&gt;</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>&amp;&amp;</span><span class='hljl-t'> </span><span class='hljl-nf'>addreaction!</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:β</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>Symbol</span><span class='hljl-p'>(</span><span class='hljl-sc'>:u</span><span class='hljl-p'>,</span><span class='hljl-n'>i</span><span class='hljl-p'>)</span><span class='hljl-oB'>=&gt;</span><span class='hljl-ni'>1</span><span class='hljl-p'>,),</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nf'>Symbol</span><span class='hljl-p'>(</span><span class='hljl-sc'>:u</span><span class='hljl-p'>,</span><span class='hljl-n'>i</span><span class='hljl-oB'>-</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-oB'>=&gt;</span><span class='hljl-ni'>1</span><span class='hljl-p'>,))</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: addreaction&#33; not defined
</pre>


<p>Let&#39;s first construct an ODE model for the network</p>


<pre class='hljl'>
<span class='hljl-nf'>addodes!</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: addodes&#33; not defined
</pre>


<p>We now need to specify the initial condition, parameter vector and time interval to solve on. We start with 10000 molecules placed at the center of the domain, and setup an <code>ODEProblem</code> to solve:</p>


<pre class='hljl'>
<span class='hljl-n'>u₀</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>u₀</span><span class='hljl-p'>[</span><span class='hljl-nf'>div</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-p'>)]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>10000</span><span class='hljl-t'>
</span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-oB'>/</span><span class='hljl-p'>(</span><span class='hljl-n'>h</span><span class='hljl-oB'>*</span><span class='hljl-n'>h</span><span class='hljl-p'>)]</span><span class='hljl-t'>
</span><span class='hljl-n'>tspan</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.</span><span class='hljl-p'>,</span><span class='hljl-nfB'>.01</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>oprob</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>ODEProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>u₀</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>tspan</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: rn not defined
</pre>


<p>We are now ready to solve the problem and plot the solution. Since we have essentially generated a method of lines discretization of the diffusion equation with a discontinuous initial condition, we&#39;ll use an A-L stable implicit ODE solver, <code>Rodas5</code>, and plot the solution at a few times:</p>


<pre class='hljl'>
<span class='hljl-n'>sol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>oprob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>Rodas5</span><span class='hljl-p'>())</span><span class='hljl-t'>
</span><span class='hljl-n'>times</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nfB'>0.</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>.0001</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>.001</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>.01</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-n'>plt</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>plot</span><span class='hljl-p'>()</span><span class='hljl-t'>
</span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>time</span><span class='hljl-t'> </span><span class='hljl-kp'>in</span><span class='hljl-t'> </span><span class='hljl-n'>times</span><span class='hljl-t'>
    </span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>plt</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>sol</span><span class='hljl-p'>(</span><span class='hljl-n'>time</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>fmt</span><span class='hljl-oB'>=</span><span class='hljl-n'>fmt</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xlabel</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;i&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ylabel</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;uᵢ&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>label</span><span class='hljl-oB'>=</span><span class='hljl-nf'>string</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;t = &quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>time</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>lw</span><span class='hljl-oB'>=</span><span class='hljl-ni'>3</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>plt</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ylims</span><span class='hljl-oB'>=</span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.</span><span class='hljl-p'>,</span><span class='hljl-nfB'>10000.</span><span class='hljl-p'>))</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: oprob not defined
</pre>


<p>Here we see the characteristic diffusion of molecules from the center of the domain, resulting in a shortening and widening of the solution as <span class="math">$t$</span> increases.</p>
<p>Let&#39;s now look at a stochastic chemical kinetics jump process version of the model, where β gives the probability per time each molecule can hop from its current lattice site to an individual neighboring site. We first add in the jumps, disabling <code>regular_jumps</code> since they are not needed, and using the <code>minimal_jumps</code> flag to construct a minimal representation of the needed jumps. We then construct a <code>JumpProblem</code>, and use the Composition-Rejection Direct method, <code>DirectCR</code>, to simulate the process of the molecules hopping about on the lattice:</p>


<pre class='hljl'>
<span class='hljl-nf'>addjumps!</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>build_regular_jumps</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>minimal_jumps</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>)</span><span class='hljl-t'>

</span><span class='hljl-cs'># make the initial condition integer valued</span><span class='hljl-t'>
</span><span class='hljl-n'>u₀</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>zeros</span><span class='hljl-p'>(</span><span class='hljl-n'>Int</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>u₀</span><span class='hljl-p'>[</span><span class='hljl-nf'>div</span><span class='hljl-p'>(</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-ni'>2</span><span class='hljl-p'>)]</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>10000</span><span class='hljl-t'>

</span><span class='hljl-cs'># setup and solve the problem</span><span class='hljl-t'>
</span><span class='hljl-n'>dprob</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>DiscreteProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>u₀</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>tspan</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>jprob</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>JumpProblem</span><span class='hljl-p'>(</span><span class='hljl-n'>dprob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>DirectCR</span><span class='hljl-p'>(),</span><span class='hljl-t'> </span><span class='hljl-n'>rn</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>save_positions</span><span class='hljl-oB'>=</span><span class='hljl-p'>(</span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-kc'>false</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-n'>jsol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>solve</span><span class='hljl-p'>(</span><span class='hljl-n'>jprob</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>SSAStepper</span><span class='hljl-p'>(),</span><span class='hljl-t'> </span><span class='hljl-n'>saveat</span><span class='hljl-oB'>=</span><span class='hljl-n'>times</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: addjumps&#33; not defined
</pre>


<p>We can now plot bar graphs showing the locations of the molecules at the same set of times we examined the ODE solution. For comparison, we also plot the corresponding ODE solutions &#40;red lines&#41; that we found:</p>


<pre class='hljl'>
<span class='hljl-n'>times</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nfB'>0.</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>.0001</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>.001</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nfB'>.01</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-n'>plts</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[]</span><span class='hljl-t'>
</span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>4</span><span class='hljl-t'>
    </span><span class='hljl-n'>b</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>bar</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-n'>N</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>jsol</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>legend</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>fmt</span><span class='hljl-oB'>=</span><span class='hljl-n'>fmt</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>xlabel</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;i&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ylabel</span><span class='hljl-oB'>=</span><span class='hljl-s'>&quot;uᵢ&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>title</span><span class='hljl-oB'>=</span><span class='hljl-nf'>string</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;t = &quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>times</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]))</span><span class='hljl-t'>
    </span><span class='hljl-nf'>plot!</span><span class='hljl-p'>(</span><span class='hljl-n'>b</span><span class='hljl-p'>,</span><span class='hljl-nf'>sol</span><span class='hljl-p'>(</span><span class='hljl-n'>times</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>]))</span><span class='hljl-t'>
    </span><span class='hljl-nf'>push!</span><span class='hljl-p'>(</span><span class='hljl-n'>plts</span><span class='hljl-p'>,</span><span class='hljl-n'>b</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-nf'>plot</span><span class='hljl-p'>(</span><span class='hljl-n'>plts</span><span class='hljl-oB'>...</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: jsol not defined
</pre>


<p>Similar to the ODE solutions, we see that the molecules spread out and become more and more well-mixed throughout the domain as <span class="math">$t$</span> increases. The simulation results are noisy due to the finite numbers of molecules present in the stochsatic simulation, but since the number of molecules is large they agree well with the ODE solution at each time.</p>
<hr />
<h2>Getting Help</h2>
<p>Have a question related to DiffEqBiological or this tutorial? Feel free to ask in the DifferentialEquations.jl <a href="https://gitter.im/JuliaDiffEq/Lobby">Gitter</a>. If you think you&#39;ve found a bug in DiffEqBiological, or would like to request/discuss new functionality, feel free to open an issue on <a href="https://github.com/JuliaDiffEq/DiffEqBiological.jl">Github</a> &#40;but please check there is no related issue already open&#41;. If you&#39;ve found a bug in this tutorial, or have a suggestion, feel free to open an issue on the <a href="https://github.com/JuliaDiffEq/SciMLTutorials.jl">SciMLTutorials Github site</a>. Or, submit a pull request to SciMLTutorials updating the tutorial&#33;</p>
<hr />


<div class="markdown"><h2>Appendix</h2>
<p>This tutorial is part of the SciMLTutorials.jl repository, found at: <a href="https://github.com/SciML/SciMLTutorials.jl">https://github.com/SciML/SciMLTutorials.jl</a>.  For more information on doing scientific machine learning &#40;SciML&#41; with open source software, check out <a href="https://sciml.ai/">https://sciml.ai/</a>.</p>
</div>
<div class="markdown"><p>To locally run this tutorial, do the following commands:</p>
<pre><code>using SciMLTutorials
SciMLTutorials.weave_file&#40;&quot;models&quot;,&quot;04-diffeqbio_II_networkproperties.jmd&quot;&#41;</code></pre>
</div>
<div class="markdown"><p>Computer Information:</p>
</div>
<div class="markdown"><pre><code>Julia Version 1.4.2
Commit 44fa15b150* &#40;2020-05-23 18:35 UTC&#41;
Platform Info:
  OS: Linux &#40;x86_64-pc-linux-gnu&#41;
  CPU: Intel&#40;R&#41; Core&#40;TM&#41; i7-9700K CPU @ 3.60GHz
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-8.0.1 &#40;ORCJIT, skylake&#41;
Environment:
  JULIA_LOAD_PATH &#61; /builds/JuliaGPU/DiffEqTutorials.jl:
  JULIA_DEPOT_PATH &#61; /builds/JuliaGPU/DiffEqTutorials.jl/.julia
  JULIA_CUDA_MEMORY_LIMIT &#61; 2147483648
  JULIA_NUM_THREADS &#61; 8
</code></pre>
</div>
<div class="markdown"><p>Package Information:</p>
</div>
<div class="markdown"><pre><code>Status &#96;/builds/JuliaGPU/DiffEqTutorials.jl/tutorials/models/Project.toml&#96;
&#91;479239e8-5488-4da2-87a7-35f2df7eef83&#93; Catalyst 5.1.1
&#91;459566f4-90b8-5000-8ac3-15dfb0a30def&#93; DiffEqCallbacks 2.14.1
&#91;f3b72e0c-5b89-59e1-b016-84e28bfd966d&#93; DiffEqDevTools 2.27.0
&#91;055956cb-9e8b-5191-98cc-73ae4a59e68a&#93; DiffEqPhysics 3.6.0
&#91;0c46a032-eb83-5123-abaf-570d42b7fbaa&#93; DifferentialEquations 6.15.0
&#91;31c24e10-a181-5473-b8eb-7969acd0382f&#93; Distributions 0.23.12
&#91;587475ba-b771-5e3f-ad9e-33799f191a9c&#93; Flux 0.11.1
&#91;f6369f11-7733-5829-9624-2563aa707210&#93; ForwardDiff 0.10.12
&#91;23fbe1c1-3f47-55db-b15f-69d7ec21a316&#93; Latexify 0.14.0
&#91;961ee093-0014-501f-94e3-6117800e7a78&#93; ModelingToolkit 3.21.0
&#91;2774e3e8-f4cf-5e23-947b-6d7e65073b56&#93; NLsolve 4.4.1
&#91;315f7962-48a3-4962-8226-d0f33b1235f0&#93; NeuralPDE 2.5.0
&#91;429524aa-4258-5aef-a3af-852621145aeb&#93; Optim 1.2.0
&#91;1dea7af3-3e70-54e6-95c3-0bf5283fa5ed&#93; OrdinaryDiffEq 5.43.0
&#91;91a5bcdd-55d7-5caf-9e0b-520d859cae80&#93; Plots 1.6.12
&#91;731186ca-8d62-57ce-b412-fbd966d074cd&#93; RecursiveArrayTools 2.7.2
&#91;789caeaf-c7a9-5a7d-9973-96adeb23e2a0&#93; StochasticDiffEq 6.26.0
&#91;37e2e46d-f89d-539d-b4ee-838fcccc9c8e&#93; LinearAlgebra
&#91;2f01184e-e22b-5df5-ae63-d93ebab69eaf&#93; SparseArrays</code></pre>
</div>


        <HR/>
        <div class="footer">
          <p>
            Published from <a href="04-diffeqbio_II_networkproperties.jmd">04-diffeqbio_II_networkproperties.jmd</a>
            using <a href="http://github.com/JunoLab/Weave.jl">Weave.jl</a> v0.10.6 on 2020-10-16.
          </p>
        </div>
      </div>
    </div>
  </div>
</BODY>

</HTML>
